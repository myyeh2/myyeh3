using System;
using Matrix_0; 

// Dennis G. Zill "Differential Equations with Boundary-Value
// Problems 9th Edition"  Page 322 Example 1  

namespace ConsoleApp41
{
    internal class Program
    {
        static void Main(string[] args)
        {

double[,] y0Start = { { 1 }, { -1 }, { 0 }, { 0 } };

double[,] M = { { 1, 0 }, { 0, 1 } };
double[,] K = { { 10, -4 }, { -4, 4 } };
double[,] C = { { 0, 0 }, { 0, 0 } };
MKCMatrix MKC = new MKCMatrix(M, K, C);
ReMatrix A = new ReMatrix(MKC.Matrix);

EIG eig = new EIG(A);
CxMatrix D = eig.CxMatrixD;
CxMatrix V = eig.CxVector;
CxMatrix Q = eig.CxMatrixQ;

CxToHexp Hexp = new CxToHexp(D, Q, 0);
CxMatrix MatTemp = Hexp.GetCxMatrix;
CxMatrix d = ~MatTemp * y0Start;

// 列印空間相依狀態參數。
Console.Write("\n***{0,8}空{0,7}間{0,7}狀{0,7}態{0,7}參{0,7}數{0,8}***\n", "");
Console.Write("\n***{0,5}系統特徵值V{0,5}***\n{1}\n", "", new PR(V));
Console.Write("\n***{0,5}系統特徵向量Q{0,5}***\n{1}\n", "", new PR(Q));
Console.Write("\n***{0,5}係數向量d{0,5}***\n{1}\n", "", new PR(d));

double step = 0.25;
int iRow = (int)(20 / step + 1);
int iCol = M.GetLength(1) + 1;
ReMatrix Disp = new ReMatrix(iRow, iCol);
ReMatrix Vel = new ReMatrix(iRow, iCol);
ReMatrix Acc = new ReMatrix(iRow, iCol);

for (int i = 0; i != iRow; i++)
{
    double t = step * i;

    Hexp = new CxToHexp(D, Q, t);
    MatTemp = Hexp.GetCxMatrix;
    CxMatrix yh_Cx = MatTemp * d;
    ReMatrix yh_Re = (ReMatrix)yh_Cx;

    Vel.Matrix[i, 0] = t;
    Vel.Matrix[i, 1] = yh_Re.Matrix[0, 0];
    Vel.Matrix[i, 2] = yh_Re.Matrix[1, 0];

    Disp.Matrix[i, 0] = t;
    Disp.Matrix[i, 1] = yh_Re.Matrix[2, 0];
    Disp.Matrix[i, 2] = yh_Re.Matrix[3, 0];

    ReMatrix yhDot_Re = A * yh_Re; 
    Acc.Matrix[i, 0] = t;
    Acc.Matrix[i, 1] = yhDot_Re.Matrix[0, 0];
    Acc.Matrix[i, 2] = yhDot_Re.Matrix[1, 0];
}

// 列印空間相依狀態響應，節點之變位，速度，和加速。 
Console.Write("\n***{0,8}空{0,7}間{0,7}狀{0,7}態{0,7}響{0,7}應{0,8}***\n", "");
Console.Write("\n{0,5}***位移反應量***{0,5}\n{0,8}時間(秒)" +
"{0,8}第0點位移{0,8}第1點位移\n\n{1}", "", new PR(Disp));
Console.Write("\n{0,5}***速度反應量***{0,5}\n{0,8}時間(秒)" +
    "{0,8}第0點速度{0,8}第1點速度\n\n{1}", "", new PR(Vel));
Console.Write("\n***{0,5}加速度反應量{0,5}***\n{0,8}時間(秒)" +
    "{0,8}第0點加速度{0,7}第1點加速度\n\n{1}", "", new PR(Acc)); 

        }
    }
}

/*
***     空     間     狀     態     參     數     ***

***     系統特徵值V     ***
        0.00000  +         3.46410i
        0.00000  -         3.46410i
        0.00000  +         1.41421i
        0.00000  -         1.41421i

***     系統特徵向量Q     ***
  0.85934  +    0.00000i,    0.85934  +     0.00000i,
  0.36515  +    0.00000i,    0.36515  +     0.00000i

 -0.42967  +    0.00000i,   -0.42967  +     0.00000i,
  0.73030  +    0.00000i,    0.73030  +     0.00000i

  0.00000  -    0.24807i,    0.00000  +     0.24807i,
  0.00000  -    0.25820i,    0.00000  +     0.25820i

  0.00000  +    0.12403i,    0.00000  -     0.12403i,
  0.00000  -    0.51640i,    0.00000  +     0.51640i

***     係數向量d     ***
        0.69821  +         0.00000i
        0.69821  +         0.00000i
       -0.27386  +         0.00000i
       -0.27386  +         0.00000i


***     空     間     狀     態     響     應     ***

     ***位移反應量***
        時間(秒)        第0點位移        第1點位移
        0.00000          0.00000          0.00000
        0.25000          0.21492         -0.22987
        0.50000          0.25004         -0.35470
        0.75000          0.05573         -0.33640
        1.00000         -0.24948         -0.22449
        1.25000         -0.46009         -0.11667
        1.50000         -0.42719         -0.08772
        1.75000         -0.16339         -0.13694
        2.00000          0.16470         -0.19127
        2.25000          0.35150         -0.16148
        2.50000          0.29406         -0.01133
        2.75000          0.06104          0.20983
        3.00000         -0.15916          0.39484
        3.25000         -0.19405          0.44820
        3.50000         -0.01072          0.34900
        3.75000          0.25996          0.16362
        4.00000          0.41574         -0.00063
        4.25000          0.32686         -0.06818
        4.50000          0.02989         -0.04347
        4.75000         -0.29475         -0.00140
        5.00000         -0.44636         -0.02744
        5.25000         -0.34180         -0.15056
        5.50000         -0.07117         -0.31695
        5.75000          0.16771         -0.42386
        6.00000          0.20952         -0.39017
        6.25000          0.03749         -0.21425
        6.50000         -0.20635          0.02175
        6.75000         -0.32377          0.20462
        7.00000         -0.20324          0.26322
        7.25000          0.09796          0.21151
        7.50000          0.39066          0.13182
        7.75000          0.48419          0.11123
        8.00000          0.31878          0.17642
        8.25000          0.00684          0.27333
        8.50000         -0.24565          0.30628
        8.75000         -0.28252          0.20873
        9.00000         -0.10476         -0.00449
        9.25000          0.13358         -0.24096
        9.50000          0.23739         -0.38862
        9.75000          0.11133         -0.38795
       10.00000         -0.17031         -0.26839
       10.25000         -0.41411         -0.12402
       10.50000         -0.44314         -0.04607
       10.75000         -0.22224         -0.05999
       11.00000          0.11545         -0.11112
       11.25000          0.35943         -0.10880
       11.50000          0.36673          0.00308
       11.75000          0.15905          0.19940
       12.00000         -0.09587          0.38483
       12.25000         -0.20504          0.45571
       12.50000         -0.08778          0.36968
       12.75000          0.16696          0.17462
       13.00000          0.36405         -0.02355
       13.25000          0.34155         -0.13153
       13.50000          0.08761         -0.12865
       13.75000         -0.24773         -0.07456
       14.00000         -0.45468         -0.06013
       14.25000         -0.40817         -0.13687
       14.50000         -0.15337         -0.27557
       14.75000          0.12764         -0.38380
       15.00000          0.24444         -0.37035
       15.25000          0.13147         -0.21132
       15.50000         -0.10790          0.02893
       15.75000         -0.27710          0.23718
       16.00000         -0.22823          0.32420
       16.25000          0.03016          0.28046
       16.50000          0.33595          0.17648
       16.75000          0.48512          0.10818
       17.00000          0.37409          0.12661
       17.25000          0.07243          0.20154
       17.50000         -0.22502          0.24496
       17.75000         -0.33324          0.17738
       18.00000         -0.20426         -0.01013
       18.25000          0.04250         -0.24264
       18.50000          0.20792         -0.40710
       18.75000          0.15650         -0.42564
       19.00000         -0.08581         -0.30576
       19.25000         -0.34866         -0.13248
       19.50000         -0.43720         -0.00840
       19.75000         -0.27055          0.01617
       20.00000          0.05899         -0.02598

     ***速度反應量***
        時間(秒)        第0點速度        第1點速度
        0.00000          1.00000         -1.00000
        0.25000          0.58980         -0.76397
        0.50000         -0.34472         -0.20776
        0.75000         -1.12473          0.31822
        1.00000         -1.16932          0.50669
        1.25000         -0.40848          0.30209
        1.50000          0.66276         -0.06981
        1.75000          1.32798         -0.27106
        2.00000          1.14918         -0.09891
        2.25000          0.27150          0.36384
        2.50000         -0.68137          0.80239
        2.75000         -1.04714          0.89027
        3.00000         -0.59027          0.52147
        3.25000          0.33488         -0.10947
        3.50000          1.03764         -0.63639
        3.75000          0.98231         -0.76972
        4.00000          0.17047         -0.49033
        4.25000         -0.85551         -0.05376
        4.50000         -1.39079          0.19702
        4.75000         -1.06230          0.07757
        5.00000         -0.09099         -0.30718
        5.25000          0.86250         -0.63940
        5.50000          1.16021         -0.61797
        5.75000          0.63201         -0.17891
        6.00000         -0.30947          0.44983
        6.25000         -0.96446          0.89883
        6.50000         -0.84346          0.90829
        6.75000         -0.01543          0.50405
        7.00000          0.93873         -0.02466
        7.25000          1.33504         -0.32944
        7.50000          0.86961         -0.24519
        7.75000         -0.16423          0.09982
        8.00000         -1.07829          0.38275
        8.25000         -1.26926          0.32347
        8.50000         -0.63856         -0.10814
        8.75000          0.34260         -0.66211
        9.00000          0.96849         -0.97773
        9.25000          0.79769         -0.83397
        9.50000         -0.03596         -0.30495
        9.75000         -0.91927          0.28885
       10.00000         -1.19483          0.59990
       10.25000         -0.62831          0.48960
       10.50000          0.42146          0.11597
       10.75000          1.25027         -0.18759
       11.00000          1.30015         -0.15581
       11.25000          0.54914          0.21527
       11.50000         -0.47486          0.66225
       11.75000         -1.06577          0.84014
       12.00000         -0.83473          0.56903
       12.25000          0.01942         -0.03238
       12.50000          0.85463         -0.62152
       12.75000          1.04284         -0.86314
       13.00000          0.41724         -0.65558
       13.25000         -0.60601         -0.19390
       13.50000         -1.31786          0.17354
       13.75000         -1.21428          0.19331
       14.00000         -0.35161         -0.11527
       14.25000          0.69109         -0.47786
       14.50000          1.21635         -0.56536
       14.75000          0.89490         -0.23480
       15.00000         -0.00743          0.35989
       15.25000         -0.82181          0.86655
       15.50000         -0.95159          0.97454
       15.75000         -0.29536          0.62783
       16.00000          0.68039          0.06196
       16.25000          1.27035         -0.36076
       16.50000          1.02935         -0.40194
       16.75000          0.08958         -0.10769
       17.00000         -0.92789          0.23319
       17.25000         -1.34545          0.30267
       17.50000         -0.90137         -0.01290
       17.75000          0.06986         -0.53470
       18.00000          0.87584         -0.91205
       18.25000          0.95487         -0.86727
       18.50000          0.27087         -0.39275
       18.75000         -0.66365          0.23885
       19.00000         -1.15237          0.65906
       19.25000         -0.81025          0.65360
       19.50000          0.16022          0.30322
       19.75000          1.10687         -0.08266
       20.00000          1.38330         -0.19167

***     加速度反應量     ***
        時間(秒)        第0點加速度       第1點加速度
        0.00000         -0.00001          0.00000
        0.25000         -3.06865          1.77915
        0.50000         -3.91924          2.41899
        0.75000         -1.90291          1.56854
        1.00000          1.59692         -0.10000
        1.25000          4.13427         -1.37370
        1.50000          3.92096         -1.35785
        1.75000          1.08615         -0.10580
        2.00000         -2.41207          1.42387
        2.25000         -4.16093          2.05191
        2.50000         -2.98595          1.22157
        2.75000          0.22894         -0.59516
        3.00000          3.17096         -2.21599
        3.25000          3.73331         -2.56899
        3.50000          1.50325         -1.43891
        3.75000         -1.94513          0.38535
        4.00000         -4.15996          1.66549
        4.25000         -3.54126          1.58013
        4.50000         -0.47276          0.29344
        4.75000          2.94195         -1.17342
        5.00000          4.35380         -1.67566
        5.25000          2.81575         -0.76496
        5.50000         -0.55606          0.98310
        5.75000         -3.37252          2.36626
        6.00000         -3.65585          2.39875
        6.25000         -1.23187          1.00696
        6.50000          2.15049         -0.91239
        6.75000          4.05613         -2.11353
        7.00000          3.08526         -1.86584
        7.25000         -0.13356         -0.45420
        7.50000         -3.37930          1.03536
        7.75000         -4.39701          1.49184
        8.00000         -2.48209          0.56943
        8.25000          1.02494         -1.06597
        8.50000          3.68159         -2.20770
        8.75000          3.66015         -1.96501
        9.00000          1.02961         -0.40107
        9.25000         -2.29966          1.49816
        9.50000         -3.92842          2.50406
        9.75000         -2.66510          1.99713
       10.00000          0.62954          0.39233
       10.25000          3.64501         -1.16036
       10.50000          4.24715         -1.58829
       10.75000          1.98240         -0.64900
       11.00000         -1.59904          0.90631
       11.25000         -4.02951          1.87293
       11.50000         -3.65500          1.45460
       11.75000         -0.79295         -0.16137
       12.00000          2.49801         -1.92279
       12.25000          3.87320         -2.64298
       12.50000          2.35652         -1.82985
       12.75000         -0.97113         -0.03063
       13.00000         -3.73471          1.55041
       13.25000         -3.94160          1.89232
       13.50000         -1.39072          0.86505
       13.75000          2.17902         -0.69265
       14.00000          4.30628         -1.57820
       14.25000          3.53423         -1.08522
       14.50000          0.43145          0.48878
       14.75000         -2.81159          2.04576
       15.00000         -3.92586          2.45919
       15.25000         -2.15997          1.37115
       15.50000          1.19476         -0.54733
       15.75000          3.71966         -2.05709
       16.00000          3.57907         -2.20970
       16.25000          0.82022         -1.00121
       16.50000         -2.65356          0.63787
       16.75000         -4.41847          1.50775
       17.00000         -3.23445          0.98993
       17.25000          0.08186         -0.51644
       17.50000          3.23009         -1.87995
       17.75000          4.04190         -2.04248
       18.00000          2.00209         -0.77653
       18.25000         -1.39562          1.14059
       18.50000         -3.70759          2.46007
       18.75000         -3.26758          2.32857
       19.00000         -0.36492          0.87979
       19.25000          2.95668         -0.86472
       19.50000          4.33845         -1.71523
       19.75000          2.77016         -1.14687
       20.00000         -0.69378          0.33986

請按任意鍵繼續 . . .
*/

